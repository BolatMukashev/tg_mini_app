<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Donate Company</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: sans-serif;
            background: #121212;
            color: white;
            text-align: center;
            padding: 40px;
        }
        button {
            background-color: #0088cc;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h2>üî• –ü–æ–¥–¥–µ—Ä–∂–∏ –±–ª–æ–≥–µ—Ä–∞</h2>
    <p>–û—Ç–∫—Ä–æ–π –±–æ—Ç–∞, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –¥–æ–Ω–∞—Ç</p>
    <button id="open-bot">–û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞</button>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand(); // –≤–æ –≤–µ—Å—å —ç–∫—Ä–∞–Ω

        // –î–æ—Å—Ç–∞—ë–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        const user = tg.initDataUnsafe.user;
        const ref = tg.initDataUnsafe.start_param;

        console.log("User:", user);
        console.log("Ref:", ref);

        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
        fetch("/save_ref", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({
                tg_id: user?.id,
                ref: ref
            })
        });

        // –ö–Ω–æ–ø–∫–∞ "–û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞"
        document.getElementById("open-bot").onclick = () => {
            const botUsername = "DonateCampaignBot"; // –ø–æ–º–µ–Ω—è–π –Ω–∞ —Å–≤–æ–µ–≥–æ
            window.location.href = `https://t.me/${botUsername}?start=${ref}`;
        };
    </script>
</body>
</html>
